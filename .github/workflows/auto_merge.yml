# If I push on Develop, it will merge to all child branches (except main)
# Ex:
# - Develop -> Feature/1
# - Develop -> Feature/2
# - Develop -> Feature/3
# Feature/1 create a PR to Develop
# Now Develop is updated, so i want to automatically merge it to Feature/2 and Feature/3

name: Auto Merge

on:
  push:
    branches:
      - develop

jobs:
  update:
    name: "Auto Merge to all child branches"
    runs-on: ubuntu-latest
    steps:
      - name: "ðŸšš - Checkout develop"
        uses: actions/checkout@v2
      - name: "ðŸ”€ - Merge develop to develop G1"
        uses: mtanzi/action-automerge@v1
        id: merge
        with:
          github_token: ${{ github.token }}
          source: 'develop'
          target: 'develop-G1'
          webhook_url: ${{ secrets.WEBHOOK_URL }}
      - name: "ðŸ”€ - Merge develop to develop G2"
        uses: mtanzi/action-automerge@v1
        id: merge
        with:
          github_token: ${{ github.token }}
          source: 'develop'
          target: 'develop-G2'
          webhook_url: ${{ secrets.WEBHOOK_URL }}
      - name: "ðŸ”€ - Merge develop to develop G5"
        uses: mtanzi/action-automerge@v1
        id: merge
        with:
          github_token: ${{ github.token }}
          source: 'develop'
          target: 'develop-G5'
          webhook_url: ${{ secrets.WEBHOOK_URL }}
      - name: "ðŸ”€ - Merge develop to develop G6"
        uses: mtanzi/action-automerge@v1
        id: merge
        with:
          github_token: ${{ github.token }}
          source: 'develop'
          target: 'develop-G6'
          webhook_url: ${{ secrets.WEBHOOK_URL }}
      - name: "ðŸ”€ - Merge develop to develop G7"
        uses: mtanzi/action-automerge@v1
        id: merge
        with:
          github_token: ${{ github.token }}
          source: 'develop'
          target: 'develop-G7'
          webhook_url: ${{ secrets.WEBHOOK_URL }}
      - name: "ðŸ”€ - Merge develop to develop G8"
        uses: mtanzi/action-automerge@v1
        id: merge
        with:
          github_token: ${{ github.token }}
          source: 'develop'
          target: 'develop-G8'
          webhook_url: ${{ secrets.WEBHOOK_URL }}
      - name: "ðŸ”€ - Merge develop to develop G10"
        uses: mtanzi/action-automerge@v1
        id: merge
        with:
          github_token: ${{ github.token }}
          source: 'develop'
          target: 'develop-G10'
          webhook_url: ${{ secrets.WEBHOOK_URL }}
